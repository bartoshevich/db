{# =======================================
  КОНСТРУКТОР СУЩНОСТЕЙ ТЕКУЩЕЙ СТРАНИЦЫ
======================================== #}
{% set isHomepage = page and page.url == '/' %}
{% if not isHomepage %}

  {# 1) Базовый узел WebPage для любой непервой страницы #}
  {% set webPage = {
    "@type": "WebPage",
    "@id": (page.url | absoluteUrl(site.url)),
    "url": (page.url | absoluteUrl(site.url)),
    "name": (title.val or title) | decodeEntities | replace('"', '\\"'),
    "description": (description.val or description) | decodeEntities | replace('"', '\\"'),
    "inLanguage": "ru",
    "datePublished": page.date | isoDate,
    "dateModified": last_modified_at | default(config.buildDate) | isoDate,
    "isPartOf": { "@id": "https://bartoshevich.by/#website" }
  } %}

  {# 2) Специализация по типам страниц #}
  {% if page.url.startsWith('/blog/') and page.url != '/blog/' %}

   

  {% elif page.url == '/about/' %}
    {% set aboutPage = webPage | merge({ 
      "@type": "ProfilePage", 
      "mainEntity": { "@id": "https://bartoshevich.by/about/#person" },
      "about": { "@id": "https://bartoshevich.by/about/#person" }
    }) %}
    {% set _ = schemaParts.push(aboutPage) %}

  {% elif page.url == '/contact/' %}
    {% set contactPage = webPage | merge({ "@type": "ContactPage", "mainEntity": { "@id": "https://bartoshevich.by/about/#person" } }) %}
    {% set _ = schemaParts.push(contactPage) %}

  {% elif page.url == '/cases/' %}
    {% set collectionPage = webPage | merge({ "@type": "CollectionPage", "creator": { "@id": "https://bartoshevich.by/about/#person" } }) %}
    {% set _ = schemaParts.push(collectionPage) %}

  {% else %}
    {# Любая другая страница — просто WebPage #}
    {% set _ = schemaParts.push(webPage) %}
  {% endif %}

  {# 3) Breadcrumbs #}
  {% include "schema/breadcrumbs.njk" %}

{% endif %}
